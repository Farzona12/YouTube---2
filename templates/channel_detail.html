{% extends 'base.html' %}
{% block title %}{{ channel.title }}{% endblock title %}
{% block main %}

<style>
html {
    scroll-behavior: smooth;
}

body {
    margin: 0;
    font-family: 'Arial', sans-serif;
    background-color: #181818;
    color: #fff;
}

/* ===== CONTAINER ===== */
.container {
    max-width: 1100px;
    margin: 40px auto;
    padding: 20px;
}

/* ===== TOP HEADER ===== */
.top-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}

.page-title {
    font-size: 34px;
    font-weight: 800;
}

.top-menu {
    display: flex;
    gap: 25px;
}

.menu-link {
    color: #ccc;
    font-size: 20px;
    font-weight: 600;
    text-decoration: none;
    transition: 0.3s ease;
}

.menu-link:hover {
    color: white;
    text-shadow: 0 0 15px rgba(255,255,255,0.7);
}

/* ===== CHANNEL HEADER ===== */
.channel-header {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 40px;
}

.channel-image {
    width: 140px;
    height: 140px;
    border-radius: 16px;
    object-fit: cover;
    background-color: #303030;
}

.channel-info h1 {
    margin: 0;
    font-size: 30px;
}

.channel-info p {
    margin: 6px 0;
    color: #b0b0b0;
}

.subscribe-btn, .unsubscribe-btn {
    padding: 10px 24px;
    border: none;
    border-radius: 8px;
    color: black;
    font-weight: bold;
    cursor: pointer;
    margin-top: 10px;
    transition: 0.2s ease;
}

.subscribe-btn {
    background-color: white;
}

.unsubscribe-btn {
    background-color: #ff0000;
    color: white;
}

.subscribe-btn:hover, .unsubscribe-btn:hover {
    transform: scale(1.05);
}

/* ===== SECTIONS ===== */
.section {
    margin-top: 50px;
}

.section h2 {
    margin-bottom: 20px;
    border-bottom: 1px solid #555;
    padding-bottom: 6px;
    font-size: 26px;
}

/* ===== VIDEO GRID ===== */
.video-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 25px;
}

.video-card {
    background: #1b1b1b;
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0 6px 16px rgba(0,0,0,0.6);
    transition: 0.3s ease;
}

.video-card:hover {
    transform: translateY(-8px) scale(1.03);
    box-shadow: 0 12px 28px rgba(0,0,0,0.8);
}

.video-thumb {
    width: 100%;
    height: 560px; /* 10x15 cm approx */
    object-fit: cover;
    background: #2b2b2b;
}

.fallback {
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 70px;
    color: #777;
}

.video-info {
    padding: 12px;
}

.video-title {
    font-size: 20px;
    margin: 0 0 6px 0;
}

.video-desc {
    color: #bbb;
    font-size: 14px;
    min-height: 45px;
}

.video-meta {
    margin-top: 8px;
    font-size: 13px;
    color: #999;
    display: flex;
    gap: 5px;
}

/* ===== POSTS ===== */
.post-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 25px;
}

.post-card {
    background: #1b1b1b;
    border-radius: 14px;
    box-shadow: 0 6px 16px rgba(0,0,0,0.6);
    transition: 0.3s ease;
}

.post-card:hover {
    transform: translateY(-8px) scale(1.03);
}

.post-thumb {
    width: 100%;
    height: 260px;
    object-fit: cover;
    background: #2b2b2b;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 70px;
    color: #777;
}

.post-info {
    padding: 12px;
}

.post-text {
    color: #ddd;
    min-height: 40px;
}

.post-meta {
    margin-top: 6px;
    color: #888;
    font-size: 13px;
}

/* ===== BUTTON: GO BACK ===== */
.goback-btn {
    margin-top: 12px;
    display: inline-block;
    padding: 10px 20px;
    background: #303030;
    color: white;
    border-radius: 8px;
    font-weight: 600;
    text-decoration: none;
    transition: 0.3s ease;
}

.goback-btn:hover {
    background: #404040;
    transform: scale(1.05);
}
</style>



<div class="container" id="channel-top">

    <!-- TOP NAVIGATION -->
    <div class="top-header">
        <h1 class="menu-link" style="font-size: 34px;
    font-weight: 800;" >Your Channel</h1>

        <div class="top-menu">
            <a href="#channel-top" class="menu-link">Channel</a>
            <a href="#videos" class="menu-link">Videos</a>
            <a href="#posts" class="menu-link">Posts</a>
        </div>
    </div>



    <!-- CHANNEL HEADER -->
    <div class="channel-header">
        {% if channel.image %}
        <img src="{{ channel.image.url }}" class="channel-image">
        {% else %}
        <div class="channel-image" style="width:150px; height:150px; border-radius:50%; background-color:#3c3c3c; display:flex; align-items:center; justify-content:center; color:#fff; font-size:50px;">{{ channel.title|slice:":1" }}</div>
        {% endif %}

        <div class="channel-info">
            <h1>{{ channel.title }}</h1>
            <p>{{ channel.description }}</p>
            <p>Subscribers: {{ channel.subscribers.count }}</p>

            {% if user.is_authenticated and user != channel.owner %}
                {% if is_subscribed %}
                <form method="post">
                    {% csrf_token %}
                    <input type="submit" name="unsubscribe" class="unsubscribe-btn" value="Unsubscribe">
                </form>
                {% else %}
                <form method="post">
                    {% csrf_token %}
                    <input type="submit" name="subscribe" class="subscribe-btn" value="Subscribe">
                </form>
                {% endif %}
            {% else %}
                <a href="{% url 'channel_delete' channel.id %}" style="color:red;" class="goback-btn">Delete</a>
            {% endif %}

            <a href="{% url 'channel_list' %}" class="goback-btn">Go back</a>
        </div>
    </div>



    <!-- VIDEOS SECTION -->
    <div class="section" id="videos">
        <h2>Videos</h2>

        {% if videos %}
        <div class="video-grid">
            {% for v in videos %}
            <div class="video-card">

                {% if v.video_file %}
                <video src="{{ v.video_file.url }}" class="video-thumb" controls></video>
                {% else %}
                <div class="video-thumb fallback">{{ v.title|first|upper }}</div>
                {% endif %}

                <div class="video-info">
                    <h3 class="video-title">{{ v.title }}</h3>

                    <p class="video-desc">{{ v.description|default:"No description" }}</p>

                    <div class="video-meta">
                        <span>{{ v.views_count }} views</span>
                        <span>â€¢</span>
                        <span>{{ v.created_at|timesince }} ago</span>
                    </div>
                </div>

            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No videos yet. <a href="{% url 'video_create' channel.id %}">Upload one</a></p>
        {% endif %}
    </div>



    <!-- POSTS SECTION -->
    <div class="section" id="posts">
        <h2>Posts</h2>

        {% if posts %}
        <div class="post-grid">
            {% for p in posts %}
            <div class="post-card">

                {% if p.image %}
                <img class="post-thumb" src="{{ p.image.url }}">
                {% elif p.video %}
                <video class="post-thumb" src="{{ p.video.url }}" controls></video>
                {% else %}
                <div class="post-thumb">{{ p.content|first|upper }}</div>
                {% endif %}

                <div class="post-info">
                    <p class="post-text">{{ p.content|default:"No content" }}</p>
                    <div class="post-meta">
                        By {{ p.user.get_full_name|default:"User" }}
                    </div>
                </div>

            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No posts yet. <a href="{% url 'post_create' channel.id %}">Create one</a></p>
        {% endif %}
    </div>

</div>

{% endblock main %}
